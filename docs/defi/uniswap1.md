---
title: Uniswap 与 X*Y=K
slug: /uniswap1
---

在 Uniswap 智能合约中，需维持X\*Y=K恒等式。由于流动性的增减变化，以及手续费的原因，K的值其实是不断变化的，但无论K的值如何变化，X\*Y=K 始终成立。这是自动化做市商的智能合约实现方式之一，还有其他流行的算法实现，比如 Balancer、Bancor 等。

### 流动性提供者

流动性提供者按比例增添 X 与 Y,或撤出流动性（按比例减少 X 与 Y），并按流动性贡献度比例（LP）分享交易手续费。

### 交易者/套利者

投入一种币，兑换另一种币，并按照 X\*Y=K 的公式，增加一种币的量，获取（使其量减少）另一种币，并贡献交易手续费。

### 无常损失（Impermanent Loss）

1、在外部市场中，xToken 的价格相对 yToken 的价格急剧下跌（比如 xToken 合约出现漏洞，可以无限增发，导致 xToken 价格归零），但此时 Uniswap 仍然按照公式计算兑换价格，相对于外部市场来说，套利者在 Uniswap 中抛售 xToken，可以购买到更多的 yToken，流动性提供者因此遭受损失，为套利者买单。  

2、价格正常波动，但遇到技术或运气特别好的交易者，在 Uniswap 和外部市场之间不断进行 xToken 和 yToken 的兑换，并套走一定量的利润，而流动性提供者获得的交易手续费，抵不上被套走的利润，因此遭受损失，为套利者买单。

### 博弈中的动态平衡

由于无常损失的存在，流动性提供者与交易者/套利者之间始终存在博弈关系，流动性提供者同样需要预测/看准合适的进场与退出时机，以及如何在两种角色之间轮流切换。和期货合约交易一样，多空双方并非固定不变，而是互相转化的。整个系统始终在持续博弈中维持动态平衡。

### 锁仓LP挖矿平台币

LP 本身是 ERC-20 Token，为了尽量不让 LP 撤出（让大量的资金沉淀到交易池中），需要设计更多的玩法与机制，比如让 LP 持有者将 LP 锁定起来进行平台币挖矿（UNI/SUSHI）。
